{"ast":null,"code":"var _jsxFileName = \"/Users/habeebsait/Apps/food_app/web/src/pages/EditRecipe.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { supabase } from '../supabaseClient';\nimport Navigation from '../components/Navigation';\nimport { generateMyRecipesUrl, getUsernameForUrl } from '../utils/urlUtils';\nimport './CreateRecipe.css'; // Reusing CreateRecipe styles\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction EditRecipe() {\n  _s();\n  const [user, setUser] = useState(null);\n  const [profile, setProfile] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [pageLoading, setPageLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [success, setSuccess] = useState('');\n  const [title, setTitle] = useState('');\n  const [category, setCategory] = useState('');\n  const [ingredients, setIngredients] = useState(['']);\n  const [steps, setSteps] = useState(['']);\n  const [image, setImage] = useState(null);\n  const [imageUrl, setImageUrl] = useState('');\n  const [currentImageUrl, setCurrentImageUrl] = useState(''); // Store existing image URL\n\n  const [categories, setCategories] = useState([]);\n  const navigate = useNavigate();\n  const {\n    username,\n    recipeId\n  } = useParams();\n\n  // Cleanup preview URL when component unmounts or image changes\n  useEffect(() => {\n    return () => {\n      if (imageUrl && imageUrl.startsWith('blob:')) {\n        URL.revokeObjectURL(imageUrl);\n      }\n    };\n  }, [imageUrl]);\n  useEffect(() => {\n    loadUserCategoriesAndRecipe();\n  }, [navigate, username, recipeId]);\n  const loadUserCategoriesAndRecipe = async () => {\n    try {\n      // Check authentication\n      const {\n        data: {\n          user: currentUser\n        }\n      } = await supabase.auth.getUser();\n      setUser(currentUser);\n      if (!currentUser) {\n        navigate('/');\n        return;\n      }\n\n      // Load user profile\n      const {\n        data: userProfile,\n        error: profileError\n      } = await supabase.from('profiles').select('username, full_name').eq('id', currentUser.id).single();\n      if (profileError && profileError.code !== 'PGRST116') {\n        console.error('Error loading profile:', profileError);\n      } else {\n        setProfile(userProfile);\n      }\n\n      // Validate that the username in URL matches current user\n      const expectedUsername = getUsernameForUrl(currentUser, userProfile);\n      if (username !== expectedUsername) {\n        navigate(`/${expectedUsername}/my-recipes`);\n        return;\n      }\n\n      // Load categories\n      const {\n        data: categoriesData,\n        error: categoriesError\n      } = await supabase.from('categories').select('id, name').order('name', {\n        ascending: true\n      });\n      if (categoriesError) {\n        console.error('Error loading categories:', categoriesError);\n      } else {\n        setCategories(categoriesData || []);\n      }\n\n      // Load existing recipe data\n      const {\n        data: recipeData,\n        error: recipeError\n      } = await supabase.from('user_recipes').select('*').eq('id', recipeId).eq('user_id', currentUser.id) // Ensure user can only edit their own recipes\n      .single();\n      if (recipeError) {\n        if (recipeError.code === 'PGRST116') {\n          setError('Recipe not found or you do not have permission to edit it.');\n        } else {\n          throw recipeError;\n        }\n        return;\n      }\n\n      // Populate form with existing recipe data\n      setTitle(recipeData.title || '');\n      setCategory(recipeData.category || '');\n      setIngredients(recipeData.ingredients || ['']);\n      setSteps(recipeData.steps || ['']);\n      setCurrentImageUrl(recipeData.image_url || '');\n    } catch (err) {\n      console.error('Error loading data:', err);\n      setError(`Failed to load recipe: ${err.message}`);\n    } finally {\n      setPageLoading(false);\n    }\n  };\n  const handleImageChange = e => {\n    const file = e.target.files[0];\n    if (file) {\n      // Revoke previous blob URL\n      if (imageUrl && imageUrl.startsWith('blob:')) {\n        URL.revokeObjectURL(imageUrl);\n      }\n      setImage(file);\n      setImageUrl(URL.createObjectURL(file));\n    }\n  };\n  const addIngredient = () => {\n    setIngredients([...ingredients, '']);\n  };\n  const removeIngredient = index => {\n    if (ingredients.length > 1) {\n      setIngredients(ingredients.filter((_, i) => i !== index));\n    }\n  };\n  const updateIngredient = (index, value) => {\n    const newIngredients = [...ingredients];\n    newIngredients[index] = value;\n    setIngredients(newIngredients);\n  };\n  const addStep = () => {\n    setSteps([...steps, '']);\n  };\n  const removeStep = index => {\n    if (steps.length > 1) {\n      setSteps(steps.filter((_, i) => i !== index));\n    }\n  };\n  const updateStep = (index, value) => {\n    const newSteps = [...steps];\n    newSteps[index] = value;\n    setSteps(newSteps);\n  };\n  const uploadImage = async () => {\n    if (!image) return currentImageUrl; // Return existing image URL if no new image\n\n    try {\n      const fileExt = image.name.split('.').pop();\n      const fileName = `${user.id}_${Date.now()}.${fileExt}`;\n      const filePath = `${user.id}/${fileName}`;\n      const {\n        error: uploadError\n      } = await supabase.storage.from('recipe-images').upload(filePath, image);\n      if (uploadError) {\n        throw uploadError;\n      }\n\n      // Get public URL\n      const {\n        data\n      } = supabase.storage.from('recipe-images').getPublicUrl(filePath);\n      return data.publicUrl;\n    } catch (err) {\n      console.error('Error uploading image:', err);\n      throw new Error(`Failed to upload image: ${err.message}`);\n    }\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!user) return;\n\n    // Basic validation\n    if (!title.trim()) {\n      setError('Recipe title is required');\n      return;\n    }\n    if (!category) {\n      setError('Please select a category');\n      return;\n    }\n    const validIngredients = ingredients.filter(ing => ing.trim());\n    if (validIngredients.length === 0) {\n      setError('At least one ingredient is required');\n      return;\n    }\n    const validSteps = steps.filter(step => step.trim());\n    if (validSteps.length === 0) {\n      setError('At least one step is required');\n      return;\n    }\n    try {\n      setLoading(true);\n      setError('');\n      setSuccess('');\n\n      // Upload new image if provided, otherwise keep existing\n      let finalImageUrl = currentImageUrl;\n      if (image) {\n        // Delete old image if it exists and we're uploading a new one\n        if (currentImageUrl) {\n          try {\n            const url = new URL(currentImageUrl);\n            const pathParts = url.pathname.split('/');\n            const bucketIndex = pathParts.findIndex(part => part === 'recipe-images');\n            if (bucketIndex !== -1 && bucketIndex < pathParts.length - 1) {\n              const filePath = pathParts.slice(bucketIndex + 1).join('/');\n              await supabase.storage.from('recipe-images').remove([filePath]);\n            }\n          } catch (imageError) {\n            console.warn('Error deleting old image:', imageError);\n            // Continue with update even if old image deletion fails\n          }\n        }\n        finalImageUrl = await uploadImage();\n      }\n\n      // Update recipe in database\n      const {\n        error: updateError\n      } = await supabase.from('user_recipes').update({\n        title: title.trim(),\n        category: category,\n        ingredients: validIngredients,\n        steps: validSteps,\n        image_url: finalImageUrl,\n        updated_at: new Date().toISOString()\n      }).eq('id', recipeId).eq('user_id', user.id);\n      if (updateError) {\n        throw updateError;\n      }\n      setSuccess('Recipe updated successfully!');\n\n      // Redirect to my recipes after a short delay\n      setTimeout(() => {\n        const userUsername = getUsernameForUrl(user, profile);\n        navigate(generateMyRecipesUrl(userUsername));\n      }, 2000);\n    } catch (err) {\n      console.error('Error updating recipe:', err);\n      setError(`Failed to update recipe: ${err.message}`);\n    } finally {\n      setLoading(false);\n    }\n  };\n  if (pageLoading) {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Navigation, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 286,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"create-recipe-page\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"create-recipe-container\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"loading-state\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"spinner\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 290,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Loading recipe...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 291,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 289,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 288,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Navigation, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"create-recipe-page\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"create-recipe-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"page-header\",\n          children: /*#__PURE__*/_jsxDEV(\"h1\", {\n            className: \"page-title\",\n            children: \"Edit Recipe\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 305,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 11\n        }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"error-message\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 309,\n          columnNumber: 13\n        }, this), success && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"success-message\",\n          children: success\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleSubmit,\n          className: \"recipe-form\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"title\",\n              className: \"form-label\",\n              children: \"Recipe Title *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 323,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              id: \"title\",\n              value: title,\n              onChange: e => setTitle(e.target.value),\n              className: \"form-input\",\n              placeholder: \"Enter recipe title\",\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 324,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 322,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"category\",\n              className: \"form-label\",\n              children: \"Category *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 337,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              id: \"category\",\n              value: category,\n              onChange: e => setCategory(e.target.value),\n              className: \"form-select\",\n              required: true,\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                children: \"Select a category\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 345,\n                columnNumber: 17\n              }, this), categories.map(cat => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: cat.name,\n                children: cat.name\n              }, cat.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 347,\n                columnNumber: 19\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 338,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 336,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"image\",\n              className: \"form-label\",\n              children: \"Recipe Image\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 356,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"file\",\n              id: \"image\",\n              accept: \"image/*\",\n              onChange: handleImageChange,\n              className: \"form-input file-input\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 357,\n              columnNumber: 15\n            }, this), (imageUrl || currentImageUrl) && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"image-preview\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: imageUrl || currentImageUrl,\n                alt: \"Recipe preview\",\n                className: \"preview-image\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 366,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 365,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 355,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"form-label\",\n              children: \"Ingredients *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 377,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"dynamic-list\",\n              children: [ingredients.map((ingredient, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"list-item\",\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  value: ingredient,\n                  onChange: e => updateIngredient(index, e.target.value),\n                  className: \"form-input\",\n                  placeholder: `Ingredient ${index + 1}`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 381,\n                  columnNumber: 21\n                }, this), ingredients.length > 1 && /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  onClick: () => removeIngredient(index),\n                  className: \"remove-btn\",\n                  title: \"Remove ingredient\",\n                  children: \"\\xD7\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 389,\n                  columnNumber: 23\n                }, this)]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 380,\n                columnNumber: 19\n              }, this)), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                onClick: addIngredient,\n                className: \"add-btn\",\n                children: \"+ Add Ingredient\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 400,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 378,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 376,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"form-label\",\n              children: \"Cooking Steps *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 412,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"dynamic-list\",\n              children: [steps.map((step, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"list-item\",\n                children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n                  value: step,\n                  onChange: e => updateStep(index, e.target.value),\n                  className: \"form-textarea\",\n                  placeholder: `Step ${index + 1}`,\n                  rows: \"3\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 416,\n                  columnNumber: 21\n                }, this), steps.length > 1 && /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  onClick: () => removeStep(index),\n                  className: \"remove-btn\",\n                  title: \"Remove step\",\n                  children: \"\\xD7\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 424,\n                  columnNumber: 23\n                }, this)]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 415,\n                columnNumber: 19\n              }, this)), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                onClick: addStep,\n                className: \"add-btn\",\n                children: \"+ Add Step\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 435,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 413,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 411,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-actions\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: () => {\n                const userUsername = getUsernameForUrl(user, profile);\n                navigate(generateMyRecipesUrl(userUsername));\n              },\n              className: \"cancel-btn\",\n              children: \"Cancel\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 447,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              disabled: loading,\n              className: \"submit-btn\",\n              children: loading ? 'Updating Recipe...' : 'Update Recipe'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 457,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 446,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 303,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 302,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n_s(EditRecipe, \"gliTS5aDbrXNav0Bjg1VTZHJ78c=\", false, function () {\n  return [useNavigate, useParams];\n});\n_c = EditRecipe;\nexport default EditRecipe;\nvar _c;\n$RefreshReg$(_c, \"EditRecipe\");","map":{"version":3,"names":["React","useState","useEffect","useNavigate","useParams","supabase","Navigation","generateMyRecipesUrl","getUsernameForUrl","jsxDEV","_jsxDEV","Fragment","_Fragment","EditRecipe","_s","user","setUser","profile","setProfile","loading","setLoading","pageLoading","setPageLoading","error","setError","success","setSuccess","title","setTitle","category","setCategory","ingredients","setIngredients","steps","setSteps","image","setImage","imageUrl","setImageUrl","currentImageUrl","setCurrentImageUrl","categories","setCategories","navigate","username","recipeId","startsWith","URL","revokeObjectURL","loadUserCategoriesAndRecipe","data","currentUser","auth","getUser","userProfile","profileError","from","select","eq","id","single","code","console","expectedUsername","categoriesData","categoriesError","order","ascending","recipeData","recipeError","image_url","err","message","handleImageChange","e","file","target","files","createObjectURL","addIngredient","removeIngredient","index","length","filter","_","i","updateIngredient","value","newIngredients","addStep","removeStep","updateStep","newSteps","uploadImage","fileExt","name","split","pop","fileName","Date","now","filePath","uploadError","storage","upload","getPublicUrl","publicUrl","Error","handleSubmit","preventDefault","trim","validIngredients","ing","validSteps","step","finalImageUrl","url","pathParts","pathname","bucketIndex","findIndex","part","slice","join","remove","imageError","warn","updateError","update","updated_at","toISOString","setTimeout","userUsername","children","_jsxFileName","lineNumber","columnNumber","className","onSubmit","htmlFor","type","onChange","placeholder","required","map","cat","accept","src","alt","ingredient","onClick","rows","disabled","_c","$RefreshReg$"],"sources":["/Users/habeebsait/Apps/food_app/web/src/pages/EditRecipe.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { supabase } from '../supabaseClient';\nimport Navigation from '../components/Navigation';\nimport { generateMyRecipesUrl, getUsernameForUrl } from '../utils/urlUtils';\nimport './CreateRecipe.css'; // Reusing CreateRecipe styles\n\nfunction EditRecipe() {\n  const [user, setUser] = useState(null);\n  const [profile, setProfile] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [pageLoading, setPageLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [success, setSuccess] = useState('');\n  \n  const [title, setTitle] = useState('');\n  const [category, setCategory] = useState('');\n  const [ingredients, setIngredients] = useState(['']);\n  const [steps, setSteps] = useState(['']);\n  const [image, setImage] = useState(null);\n  const [imageUrl, setImageUrl] = useState('');\n  const [currentImageUrl, setCurrentImageUrl] = useState(''); // Store existing image URL\n  \n  const [categories, setCategories] = useState([]);\n  \n  const navigate = useNavigate();\n  const { username, recipeId } = useParams();\n\n  // Cleanup preview URL when component unmounts or image changes\n  useEffect(() => {\n    return () => {\n      if (imageUrl && imageUrl.startsWith('blob:')) {\n        URL.revokeObjectURL(imageUrl);\n      }\n    };\n  }, [imageUrl]);\n\n  useEffect(() => {\n    loadUserCategoriesAndRecipe();\n  }, [navigate, username, recipeId]);\n\n  const loadUserCategoriesAndRecipe = async () => {\n    try {\n      // Check authentication\n      const { data: { user: currentUser } } = await supabase.auth.getUser();\n      setUser(currentUser);\n      \n      if (!currentUser) {\n        navigate('/');\n        return;\n      }\n\n      // Load user profile\n      const { data: userProfile, error: profileError } = await supabase\n        .from('profiles')\n        .select('username, full_name')\n        .eq('id', currentUser.id)\n        .single();\n\n      if (profileError && profileError.code !== 'PGRST116') {\n        console.error('Error loading profile:', profileError);\n      } else {\n        setProfile(userProfile);\n      }\n\n      // Validate that the username in URL matches current user\n      const expectedUsername = getUsernameForUrl(currentUser, userProfile);\n      if (username !== expectedUsername) {\n        navigate(`/${expectedUsername}/my-recipes`);\n        return;\n      }\n\n      // Load categories\n      const { data: categoriesData, error: categoriesError } = await supabase\n        .from('categories')\n        .select('id, name')\n        .order('name', { ascending: true });\n\n      if (categoriesError) {\n        console.error('Error loading categories:', categoriesError);\n      } else {\n        setCategories(categoriesData || []);\n      }\n\n      // Load existing recipe data\n      const { data: recipeData, error: recipeError } = await supabase\n        .from('user_recipes')\n        .select('*')\n        .eq('id', recipeId)\n        .eq('user_id', currentUser.id) // Ensure user can only edit their own recipes\n        .single();\n\n      if (recipeError) {\n        if (recipeError.code === 'PGRST116') {\n          setError('Recipe not found or you do not have permission to edit it.');\n        } else {\n          throw recipeError;\n        }\n        return;\n      }\n\n      // Populate form with existing recipe data\n      setTitle(recipeData.title || '');\n      setCategory(recipeData.category || '');\n      setIngredients(recipeData.ingredients || ['']);\n      setSteps(recipeData.steps || ['']);\n      setCurrentImageUrl(recipeData.image_url || '');\n\n    } catch (err) {\n      console.error('Error loading data:', err);\n      setError(`Failed to load recipe: ${err.message}`);\n    } finally {\n      setPageLoading(false);\n    }\n  };\n\n  const handleImageChange = (e) => {\n    const file = e.target.files[0];\n    if (file) {\n      // Revoke previous blob URL\n      if (imageUrl && imageUrl.startsWith('blob:')) {\n        URL.revokeObjectURL(imageUrl);\n      }\n      \n      setImage(file);\n      setImageUrl(URL.createObjectURL(file));\n    }\n  };\n\n  const addIngredient = () => {\n    setIngredients([...ingredients, '']);\n  };\n\n  const removeIngredient = (index) => {\n    if (ingredients.length > 1) {\n      setIngredients(ingredients.filter((_, i) => i !== index));\n    }\n  };\n\n  const updateIngredient = (index, value) => {\n    const newIngredients = [...ingredients];\n    newIngredients[index] = value;\n    setIngredients(newIngredients);\n  };\n\n  const addStep = () => {\n    setSteps([...steps, '']);\n  };\n\n  const removeStep = (index) => {\n    if (steps.length > 1) {\n      setSteps(steps.filter((_, i) => i !== index));\n    }\n  };\n\n  const updateStep = (index, value) => {\n    const newSteps = [...steps];\n    newSteps[index] = value;\n    setSteps(newSteps);\n  };\n\n  const uploadImage = async () => {\n    if (!image) return currentImageUrl; // Return existing image URL if no new image\n\n    try {\n      const fileExt = image.name.split('.').pop();\n      const fileName = `${user.id}_${Date.now()}.${fileExt}`;\n      const filePath = `${user.id}/${fileName}`;\n\n      const { error: uploadError } = await supabase.storage\n        .from('recipe-images')\n        .upload(filePath, image);\n\n      if (uploadError) {\n        throw uploadError;\n      }\n\n      // Get public URL\n      const { data } = supabase.storage\n        .from('recipe-images')\n        .getPublicUrl(filePath);\n\n      return data.publicUrl;\n    } catch (err) {\n      console.error('Error uploading image:', err);\n      throw new Error(`Failed to upload image: ${err.message}`);\n    }\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    \n    if (!user) return;\n\n    // Basic validation\n    if (!title.trim()) {\n      setError('Recipe title is required');\n      return;\n    }\n\n    if (!category) {\n      setError('Please select a category');\n      return;\n    }\n\n    const validIngredients = ingredients.filter(ing => ing.trim());\n    if (validIngredients.length === 0) {\n      setError('At least one ingredient is required');\n      return;\n    }\n\n    const validSteps = steps.filter(step => step.trim());\n    if (validSteps.length === 0) {\n      setError('At least one step is required');\n      return;\n    }\n\n    try {\n      setLoading(true);\n      setError('');\n      setSuccess('');\n\n      // Upload new image if provided, otherwise keep existing\n      let finalImageUrl = currentImageUrl;\n      if (image) {\n        // Delete old image if it exists and we're uploading a new one\n        if (currentImageUrl) {\n          try {\n            const url = new URL(currentImageUrl);\n            const pathParts = url.pathname.split('/');\n            const bucketIndex = pathParts.findIndex(part => part === 'recipe-images');\n            \n            if (bucketIndex !== -1 && bucketIndex < pathParts.length - 1) {\n              const filePath = pathParts.slice(bucketIndex + 1).join('/');\n              \n              await supabase.storage\n                .from('recipe-images')\n                .remove([filePath]);\n            }\n          } catch (imageError) {\n            console.warn('Error deleting old image:', imageError);\n            // Continue with update even if old image deletion fails\n          }\n        }\n        \n        finalImageUrl = await uploadImage();\n      }\n\n      // Update recipe in database\n      const { error: updateError } = await supabase\n        .from('user_recipes')\n        .update({\n          title: title.trim(),\n          category: category,\n          ingredients: validIngredients,\n          steps: validSteps,\n          image_url: finalImageUrl,\n          updated_at: new Date().toISOString(),\n        })\n        .eq('id', recipeId)\n        .eq('user_id', user.id);\n\n      if (updateError) {\n        throw updateError;\n      }\n\n      setSuccess('Recipe updated successfully!');\n      \n      // Redirect to my recipes after a short delay\n      setTimeout(() => {\n        const userUsername = getUsernameForUrl(user, profile);\n        navigate(generateMyRecipesUrl(userUsername));\n      }, 2000);\n\n    } catch (err) {\n      console.error('Error updating recipe:', err);\n      setError(`Failed to update recipe: ${err.message}`);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (pageLoading) {\n    return (\n      <>\n        <Navigation />\n        <div className=\"create-recipe-page\">\n          <div className=\"create-recipe-container\">\n            <div className=\"loading-state\">\n              <div className=\"spinner\"></div>\n              <p>Loading recipe...</p>\n            </div>\n          </div>\n        </div>\n      </>\n    );\n  }\n\n  return (\n    <>\n      <Navigation />\n      <div className=\"create-recipe-page\">\n        <div className=\"create-recipe-container\">\n          <div className=\"page-header\">\n            <h1 className=\"page-title\">Edit Recipe</h1>\n          </div>\n\n          {error && (\n            <div className=\"error-message\">\n              {error}\n            </div>\n          )}\n\n          {success && (\n            <div className=\"success-message\">\n              {success}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"recipe-form\">\n            {/* Recipe Title */}\n            <div className=\"form-group\">\n              <label htmlFor=\"title\" className=\"form-label\">Recipe Title *</label>\n              <input\n                type=\"text\"\n                id=\"title\"\n                value={title}\n                onChange={(e) => setTitle(e.target.value)}\n                className=\"form-input\"\n                placeholder=\"Enter recipe title\"\n                required\n              />\n            </div>\n\n            {/* Category */}\n            <div className=\"form-group\">\n              <label htmlFor=\"category\" className=\"form-label\">Category *</label>\n              <select\n                id=\"category\"\n                value={category}\n                onChange={(e) => setCategory(e.target.value)}\n                className=\"form-select\"\n                required\n              >\n                <option value=\"\">Select a category</option>\n                {categories.map((cat) => (\n                  <option key={cat.id} value={cat.name}>\n                    {cat.name}\n                  </option>\n                ))}\n              </select>\n            </div>\n\n            {/* Recipe Image */}\n            <div className=\"form-group\">\n              <label htmlFor=\"image\" className=\"form-label\">Recipe Image</label>\n              <input\n                type=\"file\"\n                id=\"image\"\n                accept=\"image/*\"\n                onChange={handleImageChange}\n                className=\"form-input file-input\"\n              />\n              {(imageUrl || currentImageUrl) && (\n                <div className=\"image-preview\">\n                  <img \n                    src={imageUrl || currentImageUrl} \n                    alt=\"Recipe preview\" \n                    className=\"preview-image\"\n                  />\n                </div>\n              )}\n            </div>\n\n            {/* Ingredients */}\n            <div className=\"form-group\">\n              <label className=\"form-label\">Ingredients *</label>\n              <div className=\"dynamic-list\">\n                {ingredients.map((ingredient, index) => (\n                  <div key={index} className=\"list-item\">\n                    <input\n                      type=\"text\"\n                      value={ingredient}\n                      onChange={(e) => updateIngredient(index, e.target.value)}\n                      className=\"form-input\"\n                      placeholder={`Ingredient ${index + 1}`}\n                    />\n                    {ingredients.length > 1 && (\n                      <button\n                        type=\"button\"\n                        onClick={() => removeIngredient(index)}\n                        className=\"remove-btn\"\n                        title=\"Remove ingredient\"\n                      >\n                        ×\n                      </button>\n                    )}\n                  </div>\n                ))}\n                <button\n                  type=\"button\"\n                  onClick={addIngredient}\n                  className=\"add-btn\"\n                >\n                  + Add Ingredient\n                </button>\n              </div>\n            </div>\n\n            {/* Steps */}\n            <div className=\"form-group\">\n              <label className=\"form-label\">Cooking Steps *</label>\n              <div className=\"dynamic-list\">\n                {steps.map((step, index) => (\n                  <div key={index} className=\"list-item\">\n                    <textarea\n                      value={step}\n                      onChange={(e) => updateStep(index, e.target.value)}\n                      className=\"form-textarea\"\n                      placeholder={`Step ${index + 1}`}\n                      rows=\"3\"\n                    />\n                    {steps.length > 1 && (\n                      <button\n                        type=\"button\"\n                        onClick={() => removeStep(index)}\n                        className=\"remove-btn\"\n                        title=\"Remove step\"\n                      >\n                        ×\n                      </button>\n                    )}\n                  </div>\n                ))}\n                <button\n                  type=\"button\"\n                  onClick={addStep}\n                  className=\"add-btn\"\n                >\n                  + Add Step\n                </button>\n              </div>\n            </div>\n\n            {/* Submit Button */}\n            <div className=\"form-actions\">\n              <button\n                type=\"button\"\n                onClick={() => {\n                  const userUsername = getUsernameForUrl(user, profile);\n                  navigate(generateMyRecipesUrl(userUsername));\n                }}\n                className=\"cancel-btn\"\n              >\n                Cancel\n              </button>\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"submit-btn\"\n              >\n                {loading ? 'Updating Recipe...' : 'Update Recipe'}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n}\n\nexport default EditRecipe;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}